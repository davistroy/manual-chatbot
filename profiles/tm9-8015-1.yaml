schema_version: "1.0"
manual_id: "tm9-8015-1"
manual_title: "TM 9-8015-1: Ordnance Maintenance — Engine (Willys-Overland Model MD) and Clutch"
source_url: "https://example.com/tm9-8015-1.pdf"
source_format: "pdf-ocr"

# Note: This is the poorest OCR quality manual in the M38A1 set. Chapter markers
# in the TOC are completely garbled ("CarPTEa", "GHAm~") and chapters are not
# detectable in body text (same as TM9-8015-2). L1 uses Section (Roman numeral)
# boundaries, which are partially detectable — only ~12 of an estimated 25+ sections
# survive OCR. Many section title pages are image-only (empty text). The profile
# accepts the detectable sections and relies on paragraph-level (L2) structure for
# content within missing sections.

vehicles:
  - model: "M38A1"
    years: "1952-1957"
    drive_type: ["4WD"]
    engines:
      - name: "F-head I4 (Hurricane) Model MD"
        code: "MD"
        aliases: ["F-head", "four-cylinder", "Hurricane", "Model MD", "134 cubic inch", "Willys-Overland"]
    transmissions:
      - name: "T-90 3-Speed Synchromesh"
        code: "T-90"
  - model: "M170"
    years: "1953-1957"
    drive_type: ["4WD"]
    engines:
      - name: "F-head I4 (Hurricane) Model MD"
        code: "MD"
        aliases: ["F-head", "four-cylinder", "Hurricane", "Model MD", "134 cubic inch", "Willys-Overland"]
    transmissions:
      - name: "T-90 3-Speed Synchromesh"
        code: "T-90"

structure:
  hierarchy:
    - level: 1
      name: "section"
      # Section headers use Roman numerals. OCR splits them across lines but
      # the structural parser joins per-page text. Detectable sections include:
      # I, II, III, IV, IX, X, XI (as "Xl"), XIV, XVII, XIX (engine chapter)
      # I, II, III, IV (clutch chapter)
      # I, II (ventilating chapter)
      # Many section title pages are image-only and undetectable.
      id_pattern: "^Section\\s+([IVXLC\\d]+)\\.?"
      title_pattern: "^Section\\s+[IVXLC\\d]+\\.?\\s+(.+)"
      require_known_id: true
      known_ids:
        # Engine chapter sections (Chapter 4 body, paras 30-126)
        - { id: "I", title: "Various (context-dependent)" }
        - { id: "II", title: "Various (context-dependent)" }
        - { id: "III", title: "Various (context-dependent)" }
        - { id: "IV", title: "Various (context-dependent)" }
        - { id: "V", title: "Various (context-dependent)" }
        - { id: "VI", title: "Various (context-dependent)" }
        - { id: "VII", title: "Various (context-dependent)" }
        - { id: "VIII", title: "Various (context-dependent)" }
        - { id: "IX", title: "Rebuild of Crankshaft" }
        - { id: "X", title: "Rebuild of Camshaft" }
        # XI rendered as "Xl" by OCR (lowercase L for I)
        - { id: "Xl", title: "Rebuild of Flywheel Assembly" }
        - { id: "XI", title: "Rebuild of Flywheel Assembly" }
        - { id: "XII", title: "Various (context-dependent)" }
        - { id: "XIII", title: "Various (context-dependent)" }
        - { id: "XIV", title: "Rebuild of Oil Pump Assembly" }
        - { id: "XV", title: "Various (context-dependent)" }
        - { id: "XVI", title: "Various (context-dependent)" }
        - { id: "XVII", title: "Cleaning, Inspection, and Repair" }
        - { id: "XVIII", title: "Various (context-dependent)" }
        - { id: "XIX", title: "Engine Run-In Tests and Adjustments" }
        # Numeric variant (OCR sometimes renders "I" as "1")
        - { id: "1", title: "General / Description (numeric variant)" }
      min_gap_lines: 10
      min_content_words: 3
    - level: 2
      name: "paragraph"
      # Numbered paragraphs: "20. Description", "52. Assembly", "135. Description"
      # These are the primary structural unit in TM manuals.
      # min_content_words=15 is critical to filter specification table data
      # (numbers like "0.0021", "1.870" match the id_pattern but are not headings).
      # require_blank_before is false because this OCR does not reliably produce
      # blank lines before paragraph headings.
      id_pattern: "^(\\d+)\\.\\s"
      title_pattern: "^\\d+\\.\\s+(.+)"
      min_content_words: 15
      require_blank_before: false
  page_number:
    pattern: "^(\\d+)$"
    group_prefixed: false
  step_patterns:
    - "^([a-z])\\.\\s"
    - "^\\((\\d+)\\)\\s"
  figure_reference:
    pattern: "[Ff]ig(?:ure|\\.)?\\s+(\\d+)"
    scope: "global"
  cross_reference:
    patterns:
      - "par(?:agraph)?\\.?\\s+(\\d+[a-z]?)"
      - "TM\\s+9-\\d{4}"

safety_callouts:
  - level: "caution"
    pattern: "^Caution:"
    style: "inline"
  - level: "note"
    pattern: "^Note[.:]"
    style: "inline"

content_types:
  maintenance_schedule:
    present: false
  wiring_diagrams:
    present: false
  specification_tables:
    location: "inline"

ocr_cleanup:
  quality_estimate: "poor"
  known_substitutions:
    # Garbled document-level markers (TOC only — unrecoverable in body)
    - { from: "CarPTEa", to: "CHAPTER" }
    - { from: "GHAm~", to: "CHAPTER" }
    - { from: "MAtNTENANCE", to: "MAINTENANCE" }
    - { from: "REPATR", to: "REPAIR" }
    - { from: "Deecription", to: "Description" }
    # Garbled Section XI marker (OCR renders I as lowercase l)
    - { from: "Section Xl.", to: "Section XI." }
    # & used as k/sh in words
    - { from: "Crank&aft", to: "Crankshaft" }
    - { from: "crank&aft", to: "crankshaft" }
    - { from: "era&&aft", to: "Crankshaft" }
    - { from: "Ink&e", to: "Intake" }
    - { from: "ret&ner", to: "retainer" }
    - { from: "Rep&r", to: "Repair" }
    - { from: "Cleam&g", to: "Cleaning" }
    - { from: "Check&g", to: "Checking" }
    - { from: "In&&hag", to: "Installing" }
    - { from: "Insp&ion", to: "Inspection" }
    - { from: "pi&on", to: "piston" }
    - { from: "pi&m", to: "piston" }
    # ~ used as n/r in words
    - { from: "Euhu~t", to: "Exhaust" }
    - { from: "hwtaZ~ed", to: "installed" }
    # Z used as l (same pattern as TM9-8014)
    - { from: "Zmpection", to: "Inspection" }
    - { from: "Znstallhg", to: "Installing" }
    - { from: "Z&moving", to: "Removing" }
    - { from: "FZyzuheeZ", to: "Flywheel" }
    - { from: "C@uZer", to: "Cooler" }
    # @ used as various letters
    - { from: "F@ure", to: "Figure" }
    # Other garbled words
    - { from: "Fipwe", to: "Figure" }
    - { from: "F&we", to: "Figure" }
    - { from: "Bpecial", to: "Special" }
    - { from: "Beplace", to: "Replace" }
    - { from: "Xpecial", to: "Special" }
    - { from: "aesembliee", to: "assemblies" }
    - { from: "a48emb&l", to: "assembly" }
    - { from: "M38Al", to: "M38A1" }
    - { from: ")&ton", to: "1/4-ton" }
  regex_substitutions:
    # Smart quote normalization
    - { pattern: "\\u2019", replacement: "'" }
    - { pattern: "\\u201c", replacement: "\"" }
    - { pattern: "\\u201d", replacement: "\"" }
    # Z used as lowercase l in -Zation words
    - { pattern: "\\b(\\w+)Zation\\b", replacement: "\\1lation" }
    # ZZ used as ll
    - { pattern: "\\b(\\w+)ZZ(\\w+)\\b", replacement: "\\1ll\\2" }
    # Z at start of word where I expected (Zn -> In, Zf -> If)
    - { pattern: "\\bZn(\\w+)\\b", replacement: "In\\1" }
    - { pattern: "\\bZf\\b", replacement: "If" }
    - { pattern: "\\bZn\\b", replacement: "In" }
    - { pattern: "\\bZs\\b", replacement: "Is" }
  header_footer_patterns:
    - "^\\*?TM\\s+9-8015"
    - "^324309\\s+0"
    - "^prod[&u].*Military.*Inc"
    - "^THIS CD PRODUCED BY"
    - "^MILITARY MEDIA"
    - "^COPY\\s?RIGHT"
    - "^copyright\\s+\\d{4}"
  garbage_detection:
    enabled: true
    threshold: 0.3

variants:
  has_market_variants: false
  variant_indicator: "none"
  markets: ["US military"]

# Many paragraph-numbered cross-references (par. 69, par. 51b, etc.) reference
# paragraphs that are NOT structural boundaries (they're just numbered paragraphs
# in the prose). With many section title pages being image-only, cross-ref targets
# are frequently unresolvable. Downgrade to warning to avoid QA failure.
cross_ref_unresolved_severity: "warning"
