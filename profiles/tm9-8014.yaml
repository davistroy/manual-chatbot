schema_version: "1.0"
manual_id: "tm9-8014-m38a1"
manual_title: "TM 9-8014: Operation and Organizational Maintenance — 1/4-Ton 4x4 Utility Truck M38A1 and Ambulance M170"
source_url: "https://example.com/tm9-8014.pdf"
source_format: "pdf-ocr"

vehicles:
  - model: "M38A1"
    years: "1952-1957"
    drive_type: ["4WD"]
    engines:
      - name: "F-head I4 (Hurricane)"
        code: "F-head"
        aliases: ["F-head", "four-cylinder", "Hurricane", "F-head I4", "4-cylinder"]
    transmissions:
      - name: "T-90 3-Speed Synchromesh"
        code: "T-90"
  - model: "M170"
    years: "1953-1957"
    drive_type: ["4WD"]
    engines:
      - name: "F-head I4 (Hurricane)"
        code: "F-head"
        aliases: ["F-head", "four-cylinder", "Hurricane", "F-head I4", "4-cylinder"]
    transmissions:
      - name: "T-90 3-Speed Synchromesh"
        code: "T-90"

structure:
  hierarchy:
    - level: 1
      name: "chapter"
      # CHAPTER markers are garbled in OCR ("CHAPTEIR", "CHAPTEa") or absent
      # (image-only pages for Chapters 2 and 3). Rely on require_known_id
      # with OCR substitutions to detect what we can, and accept missing chapters.
      id_pattern: "^CHAPTER\\s+(\\d+)"
      title_pattern: "^CHAPTER\\s+\\d+\\.?\\s+(.+)"
      require_known_id: true
      known_ids:
        - { id: "1", title: "Introduction" }
        - { id: "2", title: "Operating Instructions" }
        - { id: "3", title: "Organizational Maintenance Instructions" }
        - { id: "4", title: "Shipment and Limited Storage and Destruction of Materiel" }
    - level: 2
      name: "section"
      # Section headers use Roman numerals. OCR splits them across multiple lines:
      # "Section\nII.\nLUBRICATION\nAND\nPAINTING"
      # The structural parser joins text per-page, so the single-line form
      # "Section II. LUBRICATION AND PAINTING" must match, as well as
      # "Section IV. TROUBLESHOOTING"
      id_pattern: "^Section\\s+([IVXLC]+)\\.?"
      title_pattern: "^Section\\s+[IVXLC]+\\.?\\s+(.+)"
      min_content_words: 10
    - level: 3
      name: "paragraph"
      # Numbered paragraphs: "80. Scope", "4. Description", "69. Lubrication Chart"
      # Filter aggressively to avoid capturing numbered sub-steps within procedures
      # (e.g., "6. Installation." is often a sub-step, not a real paragraph heading)
      id_pattern: "^(\\d+)\\.\\s"
      title_pattern: "^\\d+\\.\\s+(.+)"
      require_blank_before: true
      min_content_words: 15
  page_number:
    pattern: "^(\\d+)$"
    group_prefixed: false
  step_patterns:
    - "^([a-z])\\.\\s"
    - "^\\((\\d+)\\)\\s"
  figure_reference:
    pattern: "fig\\.?\\s+(\\d+)"
    scope: "global"
  cross_reference:
    patterns:
      - "par\\.?\\s+(\\d+[a-z]?)"
      - "fig\\.?\\s+(\\d+)"

safety_callouts:
  - level: "warning"
    pattern: "^Warning:"
    style: "inline"
  - level: "caution"
    pattern: "^Caution:"
    style: "inline"
  - level: "note"
    pattern: "^Note[.:]"
    style: "inline"

content_types:
  maintenance_schedule:
    present: true
    structure: "echelon-based"
    description: "Military PM services organized by echelon (1st and 2nd echelon maintenance)."
  wiring_diagrams:
    present: true
    section_id: "Chapter 3, Section XVI-XIX"
  specification_tables:
    location: "inline"

ocr_cleanup:
  quality_estimate: "poor"
  known_substitutions:
    # Garbled CHAPTER markers
    - { from: "TECHNIG~MANUAL", to: "TECHNICAL MANUAL" }
    - { from: "CHAPTEIR", to: "CHAPTER" }
    - { from: "CHAPTEa", to: "CHAPTER" }
    # Common word garbling
    - { from: "Generd", to: "General" }
    - { from: "persomlel", to: "personnel" }
    - { from: "AIR CWiiiER", to: "AIR CLEANER" }
    - { from: "Znterference", to: "Interference" }
    # Z/I confusion in headings — specific known garbled words
    - { from: "InstaZZation", to: "Installation" }
    - { from: "InstaZlation", to: "Installation" }
    - { from: "InstalZation", to: "Installation" }
    - { from: "ZnstalZation", to: "Installation" }
    - { from: "InstaZZatiolz", to: "Installation" }
    - { from: "InstaZJatiolz", to: "Installation" }
    - { from: "Zmtallatiolz", to: "Installation" }
    - { from: "Znstaklation", to: "Installation" }
    - { from: "Znstullation", to: "Installation" }
    - { from: "Instuzlution", to: "Installation" }
    - { from: "InstuZlafio", to: "Installation" }
    - { from: "ImtaZZation", to: "Installation" }
    - { from: "ImtaZlation", to: "Installation" }
    - { from: "ZnstaLhtion", to: "Installation" }
    - { from: "ZnstaUation", to: "Installation" }
    - { from: "IZemovaZ", to: "Removal" }
    - { from: "IZemoual", to: "Removal" }
    - { from: "ZZemovuZ", to: "Removal" }
    - { from: "RemovaZ", to: "Removal" }
    - { from: "22emovaZ", to: "Removal" }
    - { from: "RepZacemerzt", to: "Replacement" }
    - { from: "PropeZZer", to: "Propeller" }
    - { from: "DisussembZy", to: "Disassembly" }
    - { from: "AssembZy", to: "Assembly" }
    - { from: "CyZinder", to: "Cylinder" }
    - { from: "FueZ", to: "Fuel" }
    - { from: "FuieZ", to: "Fuel" }
    - { from: "AxZe", to: "Axle" }
    - { from: "CooZ", to: "Cool" }
    - { from: "FaiZs", to: "Fails" }
    - { from: "FaiZme", to: "Failure" }
    # Other specific garbles found in the text
    - { from: "1nszLfficient", to: "Insufficient" }
    - { from: "serviceabZe", to: "serviceable" }
    - { from: "Ambulalzce", to: "Ambulance" }
    - { from: "Enyizte", to: "Engine" }
  regex_substitutions:
    # Catch remaining Z/I confusion patterns not covered by literal subs
    # Z used as lowercase l in words ending in -tion
    - { pattern: "\\b(\\w+)Zation\\b", replacement: "\\1lation" }
    # Z used as lowercase l in -Zl- patterns
    - { pattern: "\\b(\\w+)ZZ(\\w+)\\b", replacement: "\\1ll\\2" }
    # Z at start of word where I is expected (Znsta -> Insta, Zn -> In)
    - { pattern: "\\bZn(\\w+)\\b", replacement: "In\\1" }
    # Standalone Z used as I in "Zf" (if), "Zn" (in), "Zs" (is)
    - { pattern: "\\bZf\\b", replacement: "If" }
    - { pattern: "\\bZn\\b", replacement: "In" }
    - { pattern: "\\bZs\\b", replacement: "Is" }
  header_footer_patterns:
    - "^\\*?TM\\s+9-8014"
    - "^\\d{5,}-\\d{2}-\\d+"
    - "^339744"
  garbage_detection:
    enabled: true
    threshold: 0.3

variants:
  has_market_variants: false
  variant_indicator: "none"
  markets: ["US military"]
